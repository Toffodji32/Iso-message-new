{{ form_start(form, {
    'action': contact is defined and contact.id is not null 
        ? path('app_contact_edit', {'id': contact.id}) 
        : path('app_contact_new'),
    'method': contact is defined and contact.id is not null ? 'POST' : 'POST',
    'attr': {
        'id': 'contact-form',
        'class': 'needs-validation',
        'novalidate': 'novalidate'
    }
}) }}



<div class="card shadow-sm">
  <div class="card-header" style="background-color: #f8f9fa; border-bottom: 1px solid #dee2e6;">
    <h5 class="mb-0">{{ button_label|default('Ajouter un contact') }}</h5>
  </div>
  <div class="card-body">
    <div class="row g-3">
      {% for field in form %}
        {% if field.vars.name != '_token' %}
          {# Tous les champs sauf contactGroups en demi-largeur #}
          {% if field.vars.name != 'contactGroups' %}
            <div class="col-md-6">
              <label for="{{ field.vars.id }}" class="form-label fw-semibold">
                {{ field.vars.label }}
                {% if field.vars.required %}
                  <span class="text-danger">*</span>
                {% endif %}
              </label>

              {{ form_widget(field, {'attr': {'class': 'form-control'}}) }}

              {% if form_errors(field)|length > 0 %}
                <div class="invalid-feedback d-block">
                  {{ form_errors(field) }}
                </div>
              {% endif %}
            </div>

          {# Champ contactGroups en pleine largeur + plus grand #}
          {% else %}
            <div class="col-md-12 mt-3">
              <label for="{{ field.vars.id }}" class="form-label fw-semibold">
                {{ field.vars.label }}
                {% if field.vars.required %}
                  <span class="text-danger">*</span>
                {% endif %}
              </label>

              {{ form_widget(field, {
                'attr': {
                  'class': 'form-select',
                  'size': '6',
                  'style': 'min-height: 150px;'
                }
              }) }}

              {% if form_errors(field)|length > 0 %}
                <div class="invalid-feedback d-block">
                  {{ form_errors(field) }}
                </div>
              {% endif %}
            </div>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>

    <div class="mt-4 text-center">
      <button type="submit" class="btn btn-primary btn-lg px-5">
        {{ button_label|default('Ajouter') }}
      </button>
    </div>
  </div>
</div>

<script>
  (() => {
    'use strict'
    const forms = document.querySelectorAll('.needs-validation')
    Array.from(forms).forEach(form => {
      form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        form.classList.add('was-validated')
      }, false)
    })
  })()
</script>

{{ form_end(form) }}
